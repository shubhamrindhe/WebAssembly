<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport"
        content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
    <meta name="author" content="shubhamrindhe" id="author" />
    <title>WebAssembly - TestDrive</title>
    <style>
        body {
            padding: 0;
            margin: 0;
        }

        .center-flex {
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            vertical-align: middle;
        }

        .center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>

<body>

    <div class="center center-flex" style="width: 100%; height: 100%; background-color: red;">
        <div id="mcqueen"></div> |
        <div id="sigma"></div>
    </div>

    <script>
        let wasmExports = null;
        let wasmMemory = new WebAssembly.Memory({ initial: 256, maximum: 256 });
        let wasmTable = new WebAssembly.Table({
            'initial': 1,
            'maximum': 1,
            'element': 'anyfunc'
        });
        let asmLibraryArg = {
            "__handle_stack_overflow": () => { },
            "emscripten_resize_heap": () => { },
            "__lock": () => { },
            "__unlock": () => { },
            "memory": wasmMemory,
            "table": wasmTable
        };

        var info = {
            'env': asmLibraryArg,
            'wasi_snapshot_preview1': asmLibraryArg
        };

        async function loadWasm() {
            let response = await fetch('port.wasm');
            let bytes = await response.arrayBuffer();
            let wasmObj = await WebAssembly.instantiate(bytes, info);
            wasmExports = wasmObj.instance.exports;

            console.log(wasmExports);

            document.getElementById('mcqueen').textContent = wasmExports.mcqueen();
            document.getElementById('sigma').textContent = wasmExports.sigma(11, 98);
        }

        loadWasm();
    </script>
</body>

</html>